{"version":3,"sources":["add.projects.coffee"],"names":[],"mappings":"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","file":"add.projects.js","sourceRoot":"/source/","sourcesContent":["jQuery(document).ready ($)->\n\t\n\t#global setup\n\t$.ajaxSetup\n        headers:\n            'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n\n\t\t\n\t$('form button[type=\"reset\"]').click();\n\t$(\"select\").select2()\n\t\n\twindow.projectsCollection = []\n\t\n\t$('#add_project select[name=\"city\"]').change ->\n\t\t$.ajax\n\t\t\turl : '/some-commonfloor-url'\n\t\t\ttype : 'jsonp'\n\t\t\tsuccess : (resp)->\n\t\t\terror : (resp)->\n\t\t\t\toptions = ''\n\t\t\t\tfor i in [0...10]\n\t\t\t\t\tproject = \n\t\t\t\t\t\tproject_title : faker.name.findName()\n\t\t\t\t\t\tcf_project_id : faker.internet.userName()\n\t\t\t\t\t\tproject_image: faker.image.avatar()\n\t\t\t\t\t\tproject_address : \"#{faker.address.streetAddress()} #{faker.address.city()}, #{faker.address.zipCode()}\"\n\t\t\t\t\t\tproject_status : 'Under Construction'\n\t\t\t\t\t\tbuilder_name : faker.name.findName()\n\t\t\t\t\t\tbuilder_link : faker.internet.domainName()\n\t\t\t\t\t\t\n\t\t\t\t\tprojectsCollection.push project\n\t\t\t\t\toptions += \"<option value='#{project.cf_project_id}'>#{project.project_title}</option>\"\n\t\t\t\t\t\n\t\t\t\t$('#add_project select[name=\"cf_project_id\"]').append options\n\t\t\t\t\n\t\t\n\t$('#add_project select[name=\"cf_project_id\"]').change ->\n\t\tprojectId = $(@).val()\n\t\tproject = _.findWhere window.projectsCollection, 'cf_project_id' : projectId\n\t\t$('[name=\"project_title\"]').val project.project_title\n\t\t$('[name=\"project_address\"]').val project.project_address\n\t\ttemplate = '<div class=\"user-description-box\">\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"col-sm-8\">\n\t\t\t\t\t\t\t\t<h4 class=\"semi-bold\">{{ project_title }} - <span class=\"bold text-primary\">{{ cf_project_id }}</span></h4>\n\t\t\t\t\t\t\t\t<i class=\"fa fa-map-marker\"></i> <b>Address:</b>\n\t\t\t\t\t\t\t\t<p>{{ project_address }}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"col-sm-4\">\n\t\t\t\t\t\t\t\t{{#if project_image }} \n\t\t\t\t\t\t\t\t<img src=\"{{ project_image }}\" class=\"img-responsive\">\n\t\t\t\t\t\t\t\t{{/if}}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"alert alert-warning m-t-20\">\n\t\t\t\t\t\t\t<input type=\"hidden\" name=\"builder_name\" value={{ builder_name }}/>\n\t\t\t\t\t\t\t<input type=\"hidden\" name=\"builder_link\" value={{ builder_link }}/>\n\t\t\t\t\t\t\t<input type=\"hidden\" name=\"project_image\" value={{ project_image }}/>\n\t\t\t\t\t\t\t<strong>Note: </strong> The above information is as entered in CommonFloor database.\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>'\n\t\t\t\t\n\t\ttempalteFn = Handlebars.compile template\n\t\t$('#commonfloor-project-details').removeClass('hidden').html tempalteFn project\n\t\t\n\tregisterRemovePhaseListener = ->\n\t\t$('.remove-phase').off 'click'\n\t\t$('.remove-phase').on 'click', ->\n\n\t\t\tif confirm('Are you sure you want to delete this phase? \n\t\t\t\t\t\tAll building will be affected by this action. Continue?') is false\n\t\t\t\treturn\n\n\t\t\tphaseId = $(@).attr 'data-phase-id'\n\n\t\t\tsuccessFn = (resp, status, xhr)=>\n\t\t\t\tif xhr.status is 204\n\t\t\t\t\t$(@).closest('.pull-left').remove()\n\n\t\t\t$.ajax \n\t\t\t\turl : \"/admin/phase/#{phaseId}\"\n\t\t\t\ttype : 'DELETE'\n\t\t\t\tdata : \n\t\t\t\t\tphase_id : phaseId\n\t\t\t\tsuccess : successFn\n\t\t\n\tregisterRemovePhaseListener()\n\t\n\t$('.add-phase-btn').click ->\n\t\tphaseName = $('.phase-name').val()\n\t\t\n\t\tsuccessFn = (resp, status, xhr)->\n\t\t\tif xhr.status is 201\n\t\t\t\t$('.phase-name').val ''\n\t\t\t\tphaseId = resp.data.phase_id\n\t\t\t\tphasesContainer = $('.phases')\n\t\t\t\thtml = '<div class=\"pull-left m-r-10\">\n\t\t\t\t\t\t\t<strong>{{ phase_name }}</strong>\n\t\t\t\t\t\t\t<button type=\"button\" data-phase-id=\"{{ phase_id }}\" class=\"btn btn-small btn-link remove-phase\">\n\t\t\t\t\t\t\t<span class=\"fa fa-times text-danger\"></span></button>\n\t\t\t\t\t\t</div>'\n\t\t\t\tcompile = Handlebars.compile html\n\t\t\t\tphasesContainer.append compile( { phase_name : phaseName, phase_id : phaseId } )\n\t\t\t\tregisterRemovePhaseListener()\n\t\t\t\n\t\t$.ajax \n\t\t\turl : '/admin/phase'\n\t\t\ttype : 'POST'\n\t\t\tdata : \n\t\t\t\tproject_id : PROJECTID\n\t\t\t\tphase_name : phaseName\n\t\t\tsuccess : successFn\n\t\n\t$('[name=\"property_types[]\"]').change (evt)->\n\t\t\n\t\t$('.add-unit-types > div').addClass 'hidden'\n\t\t\t\n\t\tpropertyTypes = $(@).val()\n\t\t\n\t\t_.each propertyTypes, (propertyType)->\n\t\t\t$('.add-unit-types').find(\".property-type-#{propertyType}\").removeClass 'hidden'\n\t\t\t\n\t\t\t\t\n\t\t\t\t\n\tregisterRemoveUnitType = ->\n\t\t$('.remove-unit-type').off 'click'\n\t\t$('.remove-unit-type').on 'click', ->\n\t\t\t\n\t\t\tunitTypeId = $(@).attr 'data-unit-type-id'\n\t\t\t\n\t\t\tif parseInt(unitTypeId) is 0\n\t\t\t\t$(@).closest('.form-inline').remove()\n\t\t\t\treturn\n\t\t\t\n\t\t\tif confirm('Are you sure you want to delete this unit type? \n\t\t\t\t\t\tAll properties will be affected by this action. Continue?') is false\n\t\t\t\treturn\n\t\t\t\n\t\t\tsuccessFn = (resp, status, xhr)=>\n\t\t\t\tif xhr.status is 204\n\t\t\t\t\t$(@).closest('.form-inline').remove()\n\n\t\t\t$.ajax \n\t\t\t\turl : \"/admin/project/#{PROJECTID}/unittype/#{unitTypeId}\"\n\t\t\t\ttype : 'DELETE'\n\t\t\t\tsuccess : successFn\n\t\t\t\n\t\t\t\t\n\t\t\t\n\t\t\t\n\tregisterRemoveUnitType()\n\t$('.add-unit-type-btn').click ->\n\t\tunitType = $(@).parent().find('input').val()\n\t\tif unitType is '' then return\n\t\t\n\t\thtml = '<div class=\"form-inline m-b-10\">\n\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t<input type=\"text\" name=\"unittype[{{ property_type }}][]\" \n\t\t\t\t\t\t\t   class=\"form-control\" value=\"{{  unittype_name }}\">\n\t\t\t\t\t\t<input type=\"hidden\" name=\"unittypekey[]\" value=\"\">\n\t\t\t\t\t\t<button type=\"button\" data-unit-type-id=\"0\" class=\"btn btn-small btn-default m-t-5 remove-unit-type\">\n\t\t\t\t\t\t\t<i class=\"fa fa-trash\"></i> Delete\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>'\n\t\tcompile = Handlebars.compile html\n\t\tpropertyType = $(@).attr 'property-type'\n\t\tdata = \n\t\t\tproperty_type : propertyType\n\t\t\tunittype_name : unitType\n\t\t$('.add-unit-types').find(\".property-type-#{propertyType}\")\n\t\t\t.children('.form-inline').last().before compile data\n\t\t$(@).parent().find('input').val ''\n\t\tregisterRemoveUnitType()\n\t\t\t\n\t\t\t\n\t\t\n\t\t"]}