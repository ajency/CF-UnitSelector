{"version":3,"sources":["add.projects.coffee"],"names":[],"mappings":"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","file":"add.projects.js","sourceRoot":"/source/","sourcesContent":["jQuery(document).ready ($)->\r\n\t\r\n\t#global setup\r\n\t$.ajaxSetup\r\n        headers:\r\n            'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\r\n\r\n\t\t\r\n\t$('form button[type=\"reset\"]').click();\r\n\t$(\"select\").select2()\r\n\t\r\n\twindow.projectsCollection = []\r\n\t\r\n\t$('#add_project select[name=\"city\"]').change ->\r\n\t\t$.ajax\r\n\t\t\turl : '/some-commonfloor-url'\r\n\t\t\ttype : 'jsonp'\r\n\t\t\tsuccess : (resp)->\r\n\t\t\terror : (resp)->\r\n\t\t\t\toptions = ''\r\n\t\t\t\tfor i in [0...10]\r\n\t\t\t\t\tproject = \r\n\t\t\t\t\t\tproject_title : faker.name.findName()\r\n\t\t\t\t\t\tcf_project_id : faker.internet.userName()\r\n\t\t\t\t\t\tproject_image: 'http://cfunitselectortest.com/images/artha.gif'\r\n\t\t\t\t\t\tproject_address : \"#{faker.address.streetAddress()} #{faker.address.city()}, #{faker.address.zipCode()}\"\r\n\t\t\t\t\t\tproject_status : 'Under Construction'\r\n\t\t\t\t\t\tbuilder_name : faker.name.findName()\r\n\t\t\t\t\t\tbuilder_link : faker.internet.domainName()\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tprojectsCollection.push project\r\n\t\t\t\t\toptions += \"<option value='#{project.cf_project_id}'>#{project.project_title}</option>\"\r\n\t\t\t\t\t\r\n\t\t\t\t$('#add_project select[name=\"cf_project_id\"]').append options\r\n\t\t\t\t\r\n\t\t\r\n\t$('#add_project select[name=\"cf_project_id\"]').change ->\r\n\t\tprojectId = $(@).val()\r\n\t\tproject = _.findWhere window.projectsCollection, 'cf_project_id' : projectId\r\n\t\t$('[name=\"project_title\"],[name=\"hidden_project_title\"]').val project.project_title\r\n\t\t$('[name=\"project_address\"],[name=\"hidden_project_address\"]').val project.project_address\r\n\t\ttemplate = '<div class=\"user-description-box\">\r\n\t\t\t\t\t\t<div class=\"row\">\r\n\t\t\t\t\t\t\t<div class=\"col-sm-8\">\r\n\t\t\t\t\t\t\t\t<h4 class=\"semi-bold\">{{ project_title }} - <span class=\"bold text-primary\">{{ cf_project_id }}</span></h4>\r\n\t\t\t\t\t\t\t\t<i class=\"fa fa-map-marker\"></i> <b>Address:</b>\r\n\t\t\t\t\t\t\t\t<p>{{ project_address }}</p>\r\n\t\t\t\t\t\t\t\t<p>Builder Name: <label><b>{{ builder_name }}</b></label></p>\r\n\t\t\t\t\t\t\t\t<p>Website Link: <label><a href=\"http://{{ builder_link }}\"><b>http://{{ builder_link }}</b></a></label></p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"col-sm-4\">\r\n\t\t\t\t\t\t\t\t{{#if project_image }} \r\n\t\t\t\t\t\t\t\t<img src=\"{{ project_image }}\" class=\"img-responsive\">\r\n\t\t\t\t\t\t\t\t{{/if}}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"alert alert-warning m-t-20\">\r\n\t\t\t\t\t\t\t<input type=\"hidden\" name=\"builder_name\" value=\"{{ builder_name }}\" />\r\n\t\t\t\t\t\t\t<input type=\"hidden\" name=\"builder_link\" value=\"{{ builder_link }}\" />\r\n\t\t\t\t\t\t\t<input type=\"hidden\" name=\"project_image\" value=\"{{ project_image }}\" />\r\n\t\t\t\t\t\t\t<strong>Note: </strong> The above information is as entered in CommonFloor database.\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>'\r\n\t\t\t\t\r\n\t\ttempalteFn = Handlebars.compile template\r\n\t\t$('#commonfloor-project-details').removeClass('hidden').html tempalteFn project\r\n\t\t\r\n\tregisterRemovePhaseListener = ->\r\n\t\t$('.remove-phase').off 'click'\r\n\t\t$('.remove-phase').on 'click', ->\r\n\r\n\t\t\tif confirm('Are you sure you want to delete this phase? \r\n\t\t\t\t\t\tAll building will be affected by this action. Continue?') is false\r\n\t\t\t\treturn\r\n\r\n\t\t\tphaseId = $(@).attr 'data-phase-id'\r\n\r\n\t\t\tsuccessFn = (resp, status, xhr)=>\r\n\t\t\t\tif xhr.status is 204\r\n\t\t\t\t\t$(@).closest('.pull-left').remove()\r\n\r\n\t\t\t$.ajax \r\n\t\t\t\turl : \"/admin/phase/#{phaseId}\"\r\n\t\t\t\ttype : 'DELETE'\r\n\t\t\t\tdata : \r\n\t\t\t\t\tphase_id : phaseId\r\n\t\t\t\tsuccess : successFn\r\n\t\t\r\n\tregisterRemovePhaseListener()\r\n\t\r\n\t$('.add-phase-btn').click ->\r\n\t\tphaseName = $('.phase-name').val()\r\n\t\t\r\n\t\tif phaseName is ''\r\n\t\t\talert 'Please enter phase name'\r\n\t\t\treturn\r\n\t\t\r\n\t\tsuccessFn = (resp, status, xhr)->\r\n\t\t\tif xhr.status is 201\r\n\t\t\t\t$('.phase-name').val ''\r\n\t\t\t\tphaseId = resp.data.phase_id\r\n\t\t\t\tphasesContainer = $('.phases')\r\n\t\t\t\thtml = '<div class=\"pull-left m-r-10\">\r\n\t\t\t\t\t\t\t<strong>{{ phase_name }}</strong>\r\n\t\t\t\t\t\t\t<button type=\"button\" data-phase-id=\"{{ phase_id }}\" class=\"btn btn-small btn-link remove-phase\">\r\n\t\t\t\t\t\t\t<span class=\"fa fa-times text-danger\"></span></button>\r\n\t\t\t\t\t\t</div>'\r\n\t\t\t\tcompile = Handlebars.compile html\r\n\t\t\t\tphasesContainer.append compile( { phase_name : phaseName, phase_id : phaseId } )\r\n\t\t\t\tregisterRemovePhaseListener()\r\n\t\t\t\r\n\t\t$.ajax \r\n\t\t\turl : '/admin/phase'\r\n\t\t\ttype : 'POST'\r\n\t\t\tdata : \r\n\t\t\t\tproject_id : PROJECTID\r\n\t\t\t\tphase_name : phaseName\r\n\t\t\tsuccess : successFn\r\n\t\t\t\r\n\tcheckUnitTypeRequired = ->\r\n\t\t$('.add-unit-types > div').each ->\r\n\t\t\tactiveTypes = $(@)\r\n\t\t\tif $(@).find('.unit-type').length is 0 and not $(@).hasClass('hidden')\r\n\t\t\t\t$(@).find('.unit-type-name').attr 'data-parsley-required', true\r\n\t\t\telse\r\n\t\t\t\t$(@).find('.unit-type-name').removeAttr 'data-parsley-required'\r\n\t\t\t\r\n\t\t\t\t\r\n\t\r\n\tcheckUnitTypeRequired()\r\n\t$('[name=\"property_types[]\"]').change (evt)->\r\n\t\t\r\n\t\t$('.add-unit-types > div').addClass 'hidden'\r\n\t\tpropertyTypes = $(@).val()\r\n\t\t\r\n\t\t_.each propertyTypes, (propertyType)->\r\n\t\t\t$('.add-unit-types').find(\".property-type-#{propertyType}\").removeClass 'hidden'\r\n\t\t\r\n\t\tcheckUnitTypeRequired()\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\tregisterRemoveUnitType = ->\r\n\t\t$('.remove-unit-type').off 'click'\r\n\t\t$('.remove-unit-type').on 'click', ->\r\n\t\t\t\r\n\t\t\tunitTypeId = $(@).attr 'data-unit-type-id'\r\n\t\t\t\r\n\t\t\tif parseInt(unitTypeId) is 0\r\n\t\t\t\t$(@).closest('.form-inline').remove()\r\n\t\t\t\treturn\r\n\t\t\t\r\n\t\t\tif confirm('Are you sure you want to delete this unit type? \r\n\t\t\t\t\t\tAll properties will be affected by this action. Continue?') is false\r\n\t\t\t\treturn\r\n\t\t\t\r\n\t\t\tsuccessFn = (resp, status, xhr)=>\r\n\t\t\t\tif xhr.status is 204\r\n\t\t\t\t\t$(@).closest('.form-inline').remove()\r\n\r\n\t\t\t$.ajax \r\n\t\t\t\turl : \"/admin/project/#{PROJECTID}/unittype/#{unitTypeId}\"\r\n\t\t\t\ttype : 'DELETE'\r\n\t\t\t\tsuccess : successFn\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\tregisterRemoveUnitType()\r\n\t$('.add-unit-type-btn').click ->\r\n\t\tunitType = $(@).parent().find('input').val()\r\n\t\tif unitType is ''\r\n\t\t\talert 'please enter unit type'\r\n\t\t\treturn\r\n\t\t\t\r\n\t\t$(@).parent().find('input').removeAttr 'data-parsley-required'\r\n\t\t\r\n\t\thtml = '<div class=\"form-inline m-b-10\">\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<input type=\"text\" name=\"unittype[{{ property_type }}][]\" \r\n\t\t\t\t\t\t\t   class=\"form-control\" value=\"{{  unittype_name }}\">\r\n\t\t\t\t\t\t<input type=\"hidden\" name=\"unittypekey[]\" value=\"\">\r\n\t\t\t\t\t\t<button type=\"button\" data-unit-type-id=\"0\" class=\"btn btn-small btn-default m-t-5 remove-unit-type\">\r\n\t\t\t\t\t\t\t<i class=\"fa fa-trash\"></i> Delete\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>'\r\n\t\tcompile = Handlebars.compile html\r\n\t\tpropertyType = $(@).attr 'property-type'\r\n\t\tdata = \r\n\t\t\tproperty_type : propertyType\r\n\t\t\tunittype_name : unitType\r\n\t\t$('.add-unit-types').find(\".property-type-#{propertyType}\")\r\n\t\t\t.children('.form-inline').last().before compile data\r\n\t\t$(@).parent().find('input').val ''\r\n\t\tregisterRemoveUnitType()\r\n\t\t\r\n\t\t\r\n\t$('.floor-position button.save-position').click ->\t\r\n\t\tform = $(@).closest('form')\r\n\t\tform.parsley().validate()\r\n\t\tif form.parsley().isValid()\r\n\t\t\tformData = form.serializeArray()\t\t\r\n\t\t\tfloorLayoutId = form.find('[name=\"floor_layout_id\"]').val()\r\n\t\t\t$.ajax\r\n\t\t\t\turl : BASEURL + '/admin/floor-layout/' + floorLayoutId + '/position'\r\n\t\t\t\ttype : 'POST'\r\n\t\t\t\tdata : formData\t\t\t\t\t\r\n\t\t\t\tsuccess : (response)->\r\n\t\t\t\t\tconsole.log 'show success message'\r\n\t\t\t\t\t\r\n\t$('.floor-layout-unit-types').change ->\r\n\t\tunitTypeId = $(this).val()\r\n\t\t$(this).closest('.row').find('[name=\"unit_variant_id\"] option').hide()\r\n\t\t$(this).closest('.row').find('[name=\"unit_variant_id\"]')\r\n\t\t\t.find \"unittype-#{unitTypeId}\"\r\n\t\t\t.show()\r\n\t\t$(this).closest('.row').find('[name=\"unit_variant_id\"]').select2()\r\n\t\t\t\r\n\t\t\t\r\n\t\t\r\n\t\t"]}