{"version":3,"sources":["frontend/entities/building.entity.coffee"],"names":[],"mappings":"AACA;AAAA,MAAA,4BAAA;IAAA;+BAAA;;AAAA,EAAM;AAIL,gCAAA,CAAA;;;;KAAA;;AAAA,uBAAA,YAAA,GAAa,SAAC,WAAD,GAAA;AAEZ,UAAA,0BAAA;AAAA,MAAA,SAAA,GAAY,EAAZ,CAAA;AACA,MAAA,IAAG,WAAA,KAAe,EAAlB;AACC,eAAO,SAAP,CADD;OADA;AAAA,MAGA,KAAA,GAAQ,cAAc,CAAC,KAAf,CACJ;AAAA,QAAA,aAAA,EAAiB,QAAA,CAAS,WAAT,CAAjB;OADI,CAHR,CAAA;AAAA,MAMA,KAAA,GAAY,IAAA,QAAQ,CAAC,UAAT,CAAoB,KAApB,CANZ,CAAA;AAAA,MAOA,QAAA,GAAW,KAAK,CAAC,KAAN,CAAY,iBAAZ,CAPX,CAAA;AAAA,MAQA,CAAC,CAAC,IAAF,CAAO,QAAP,EAAgB,SAAC,KAAD,EAAO,KAAP,GAAA;AACf,YAAA,YAAA;AAAA,QAAA,YAAA,GAAe,0BAA0B,CAAC,SAA3B,CACT;AAAA,UAAA,IAAA,EAAO,QAAA,CAAS,KAAT,CAAP;SADS,CAAf,CAAA;eAEA,SAAS,CAAC,IAAV,CAAe,YAAY,CAAC,GAAb,CAAiB,cAAjB,CAAf,EAHe;MAAA,CAAhB,CARA,CAAA;AAAA,MAaA,SAAA,GAAY,CAAC,CAAC,IAAF,CAAO,SAAP,CAbZ,CAAA;aAcA,UAhBY;IAAA,CAAb,CAAA;;AAAA,uBAmBA,iBAAA,GAAkB,SAAC,WAAD,EAAa,SAAb,GAAA;AAEjB,UAAA,KAAA;AAAA,MAAA,KAAA,GAAQ,EAAR,CAAA;AACA,MAAA,IAAG,WAAA,KAAe,EAAlB;AACC,eAAO,KAAP,CADD;OADA;AAAA,MAGA,CAAC,CAAC,IAAF,CAAO,SAAP,EAAiB,SAAC,GAAD,EAAK,GAAL,GAAA;AAChB,YAAA,8BAAA;AAAA,QAAA,aAAA,GAAgB,kBAAkB,CAAC,SAAnB,CACX;AAAA,UAAA,IAAA,EAAO,GAAP;SADW,CAAhB,CAAA;AAAA,QAEA,QAAA,GAAW,0BAA0B,CAAC,KAA3B,CACP;AAAA,UAAA,cAAA,EAAiB,GAAjB;AAAA,UACA,cAAA,EAAiB,WADjB;SADO,CAFX,CAAA;AAAA,QAKA,KAAA,GAAQ,EALR,CAAA;AAAA,QAMA,CAAC,CAAC,IAAF,CAAO,QAAP,EAAgB,SAAC,KAAD,EAAO,KAAP,GAAA;AACf,cAAA,SAAA;AAAA,UAAA,SAAA,GAAY,cAAc,CAAC,KAAf,CACR;AAAA,YAAA,iBAAA,EAAoB,KAAK,CAAC,GAAN,CAAU,IAAV,CAApB;AAAA,YACA,aAAA,EAAgB,WADhB;WADQ,CAAZ,CAAA;iBAIA,CAAC,CAAC,KAAF,CAAQ,KAAR,EAAe,SAAf,EALe;QAAA,CAAhB,CANA,CAAA;eAYA,KAAK,CAAC,IAAN,CACC;AAAA,UAAA,MAAA,EAAS,aAAa,CAAC,GAAd,CAAkB,MAAlB,CAAT;AAAA,UACA,OAAA,EAAU,KAAK,CAAC,MADhB;SADD,EAbgB;MAAA,CAAjB,CAHA,CAAA;aAoBA,MAtBiB;IAAA,CAnBlB,CAAA;;AAAA,uBA4CA,cAAA,GAAe,SAAC,WAAD,GAAA;AACd,UAAA,gBAAA;AAAA,MAAA,IAAG,WAAA,KAAe,EAAlB;AACC,cAAA,CADD;OAAA;AAAA,MAEA,KAAA,GAAQ,cAAc,CAAC,KAAf,CACL;AAAA,QAAA,aAAA,EAAgB,WAAhB;OADK,CAFR,CAAA;AAAA,MAIA,IAAA,GAAO,EAJP,CAAA;AAAA,MAKA,CAAC,CAAC,IAAF,CAAO,KAAP,EAAa,SAAC,KAAD,EAAO,KAAP,GAAA;AACZ,YAAA,QAAA;AAAA,QAAA,QAAA,GAAW,0BAA0B,CAAC,SAA3B,CACP;AAAA,UAAA,IAAA,EAAO,KAAK,CAAC,GAAN,CAAU,iBAAV,CAAP;SADO,CAAX,CAAA;eAEA,IAAI,CAAC,IAAL,CAAU,QAAQ,CAAC,GAAT,CAAa,qBAAb,CAAV,EAHY;MAAA,CAAb,CALA,CAAA;AAAA,MASA,GAAA,GAAK,CATL,CAAA;AAUA,MAAA,IAAG,IAAI,CAAC,MAAL,KAAe,CAAlB;AACC,QAAA,GAAA,GAAO,CAAC,CAAC,GAAF,CAAM,IAAN,CAAP,CADD;OAVA;aAYA,IAbc;IAAA,CA5Cf,CAAA;;AAAA,uBA4DA,cAAA,GAAe,SAAC,WAAD,GAAA;AACd,UAAA,gBAAA;AAAA,MAAA,IAAG,WAAA,KAAe,EAAlB;AACC,cAAA,CADD;OAAA;AAAA,MAEA,KAAA,GAAQ,cAAc,CAAC,KAAf,CACL;AAAA,QAAA,aAAA,EAAgB,WAAhB;OADK,CAFR,CAAA;AAAA,MAIA,IAAA,GAAO,EAJP,CAAA;AAAA,MAKA,CAAC,CAAC,IAAF,CAAO,KAAP,EAAa,SAAC,KAAD,EAAO,KAAP,GAAA;AACZ,QAAA,KAAA,GAAQ,IAAI,CAAC,cAAL,CAAoB,KAAK,CAAC,GAAN,CAAU,IAAV,CAApB,CAAR,CAAA;eACA,IAAI,CAAC,IAAL,CAAU,KAAM,CAAA,CAAA,CAAhB,EAFY;MAAA,CAAb,CALA,CAAA;AAAA,MASA,GAAA,GAAK,CATL,CAAA;AAUA,MAAA,IAAG,IAAI,CAAC,MAAL,KAAe,CAAlB;AACC,QAAA,GAAA,GAAO,CAAC,CAAC,GAAF,CAAM,IAAN,CAAP,CADD;OAVA;aAYA,IAbc;IAAA,CA5Df,CAAA;;AAAA,uBA8EA,gBAAA,GAAiB,SAAC,WAAD,GAAA;AAChB,UAAA,gCAAA;AAAA,MAAA,IAAG,WAAA,KAAe,EAAlB;AACC,cAAA,CADD;OAAA;AAAA,MAEA,KAAA,GAAQ,cAAc,CAAC,KAAf,CACL;AAAA,QAAA,aAAA,EAAgB,WAAhB;OADK,CAFR,CAAA;AAAA,MAKA,UAAA,GAAa,CAAC,CAAC,MAAF,CAAS,KAAT,EAAgB,SAAC,GAAD,GAAA;AAC3B,eAAO,GAAG,CAAC,GAAJ,CAAQ,OAAR,CAAP,CAD2B;MAAA,CAAhB,CALb,CAAA;AAAA,MAQA,aAAA,GAAgB,CAAC,CAAC,MAAF,CAAS,UAAT,EAAqB,SAAC,GAAD,GAAA;AACnC,eAAO,GAAG,CAAC,GAAJ,CAAQ,UAAR,CAAP,CADmC;MAAA,CAArB,CARhB,CAAA;aAWA,MAZgB;IAAA,CA9EjB,CAAA;;AAAA,uBA6FA,iBAAA,GAAkB,SAAC,QAAD,GAAA;AACjB,UAAA,4CAAA;AAAA,MAAA,IAAG,QAAA,KAAY,EAAf;AACC,cAAA,CADD;OAAA;AAAA,MAEA,gBAAA,GAAmB,EAFnB,CAAA;AAAA,MAGA,aAAA,GAAgB,kBAAkB,CAAC,SAAnB,CAA6B;AAAA,QAAC,IAAA,EAAK,QAAA,CAAS,QAAT,CAAN;OAA7B,CAHhB,CAAA;AAAA,MAIA,WAAA,GAAc,aAAa,CAAC,GAAd,CAAkB,aAAlB,CAJd,CAAA;AAMA,MAAA,IAAG,QAAA,CAAS,WAAW,CAAC,MAArB,CAAA,GAA+B,CAAlC;AACC,QAAA,IAAC,CAAA,GAAD,CAAK,UAAL,EAAkB,CAAlB,CAAA,CADD;OAAA,MAAA;AAGC,QAAA,IAAC,CAAA,GAAD,CAAK,UAAL,EAAkB,CAAlB,CAAA,CAHD;OANA;aAWA,IAAC,CAAA,GAAD,CAAK,UAAL,EAZiB;IAAA,CA7FlB,CAAA;;oBAAA;;KAJsB,QAAQ,CAAC,MAAhC,CAAA;;AAAA,EAmHM;AACL,0CAAA,CAAA;;;;KAAA;;AAAA,iCAAA,KAAA,GAAQ,QAAR,CAAA;;AAAA,iCAEA,SAAA,GAAU,SAAA,GAAA;aACT,IAAC,CAAA,aADQ;IAAA,CAFV,CAAA;;AAAA,iCAKA,SAAA,GAAU,SAAC,KAAD,GAAA;aACT,IAAC,CAAA,YAAD,GAAgB,MADP;IAAA,CALV,CAAA;;AAAA,iCAQA,IAAA,GAAK,SAAA,GAAA;AACJ,UAAA,0BAAA;AAAA,MAAA,KAAA,GAAQ,CAAC,CAAC,KAAF,CAAQ,IAAC,CAAC,OAAF,CAAA,CAAR,EAAqB,IAArB,CAAR,CAAA;AAAA,MACA,IAAA,GAAO,IAAC,CAAA,EAAD,CAAI,IAAC,CAAA,OAAD,CAAS,IAAC,CAAA,SAAD,CAAA,CAAT,CAAA,GAAyB,CAA7B,CADP,CAAA;AAEA,MAAA,IAAG,CAAC,CAAC,WAAF,CAAc,IAAd,CAAH;AACC,QAAA,KAAA,GAAQ,CAAC,CAAC,KAAF,CAAQ,KAAR,CAAR,CAAA;AACA,QAAA,IAAG,IAAC,CAAA,YAAY,CAAC,GAAd,CAAkB,IAAlB,CAAA,KAA2B,KAA9B;iBACC,KADD;SAAA,MAAA;AAGC,UAAA,MAAA,GAAS,IAAC,CAAA,SAAD,CACR;AAAA,YAAA,IAAA,EAAO,KAAP;WADQ,CAAT,CAAA;iBAEA,OALD;SAFD;OAAA,MAAA;eASC,KATD;OAHI;IAAA,CARL,CAAA;;AAAA,iCAsBA,IAAA,GAAK,SAAA,GAAA;AACJ,UAAA,yBAAA;AAAA,MAAA,KAAA,GAAQ,CAAC,CAAC,KAAF,CAAQ,IAAC,CAAC,OAAF,CAAA,CAAR,EAAqB,IAArB,CAAR,CAAA;AAAA,MACA,IAAA,GAAO,IAAC,CAAA,EAAD,CAAI,IAAC,CAAA,OAAD,CAAS,IAAC,CAAA,SAAD,CAAA,CAAT,CAAA,GAAyB,CAA7B,CADP,CAAA;AAEA,MAAA,IAAG,CAAC,CAAC,WAAF,CAAc,IAAd,CAAH;AACC,QAAA,IAAA,GAAO,CAAC,CAAC,IAAF,CAAO,KAAP,CAAP,CAAA;AACA,QAAA,IAAG,IAAC,CAAA,YAAY,CAAC,GAAd,CAAkB,IAAlB,CAAA,KAA2B,IAA9B;iBACC,KADD;SAAA,MAAA;AAGC,UAAA,MAAA,GAAS,IAAC,CAAA,SAAD,CACR;AAAA,YAAA,IAAA,EAAO,IAAP;WADQ,CAAT,CAAA;iBAEA,OALD;SAFD;OAAA,MAAA;eASC,KATD;OAHI;IAAA,CAtBL,CAAA;;AAAA,iCAsCA,qBAAA,GAAsB,SAAC,IAAD,GAAA;AAGrB,MAAA,kBAAkB,CAAC,KAAnB,CAAyB,IAAzB,CAAA,CAAA;aACA,wBAAwB,CAAC,KAAzB,CAA+B,IAA/B,EAJqB;IAAA,CAtCtB,CAAA;;8BAAA;;KADgC,QAAQ,CAAC,WAnH1C,CAAA;;AAAA,EAgKA,MAAM,CAAC,kBAAP,GAA6B,GAAA,CAAA,kBAhK7B,CAAA;;AAAA,EAiKA,MAAM,CAAC,wBAAP,GAAmC,GAAA,CAAA,kBAjKnC,CAAA;;AAAA,EAkKA,MAAM,CAAC,QAAP,GAAmB,GAAA,CAAA,QAlKnB,CAAA;AAAA","file":"frontend/entities/building.entity.js","sourceRoot":"/source/","sourcesContent":["#Building model and Building collection Definition\r\nclass Building extends Backbone.Model\r\n\r\n\r\n\t#Get all the unit types in a building\r\n\tgetUnitTypes:(building_id)->\r\n\r\n\t\tunitTypes = []\r\n\t\tif building_id == \"\"\r\n\t\t\treturn unitTypes\r\n\t\tunits = unitCollection.where\r\n\t\t\t\t\t\t'building_id'  : parseInt building_id\r\n\r\n\t\tunits = new Backbone.Collection units\r\n\t\tvariants = units.pluck(\"unit_variant_id\") \r\n\t\t$.each variants,(index,value)->\r\n\t\t\tvarinatModel = apartmentVariantCollection.findWhere\r\n\t\t\t\t\t\t\t\t\t'id' : parseInt value\r\n\t\t\tunitTypes.push varinatModel.get 'unit_type_id'\r\n\r\n\t\tunitTypes = _.uniq unitTypes\r\n\t\tunitTypes\r\n\r\n\t#Count the number of units for each unit type in a building\r\n\tgetUnitTypesCount:(building_id,unitTypes)->\r\n\r\n\t\ttypes = []\r\n\t\tif building_id == \"\"\r\n\t\t\treturn types\r\n\t\t$.each unitTypes,(ind,val)->\r\n\t\t\tunitTypeModel = unitTypeCollection.findWhere\r\n\t\t\t\t\t\t\t\t'id' : val\r\n\t\t\tvariants = apartmentVariantCollection.where\r\n\t\t\t\t\t\t\t'unit_type_id' : val\r\n\t\t\t\t\t\t\t'availability' : 'available'\r\n\t\t\tunits = []\r\n\t\t\t$.each variants,(index,value)->\r\n\t\t\t\tunitsColl = unitCollection.where\r\n\t\t\t\t\t\t\t\t'unit_variant_id' : value.get 'id'\r\n\t\t\t\t\t\t\t\t'building_id' : building_id\r\n\r\n\t\t\t\t$.merge units, unitsColl\r\n\t\t\ttypes.push \r\n\t\t\t\t'name' : unitTypeModel.get 'name'\r\n\t\t\t\t'units' : units.length\r\n\r\n\t\ttypes\r\n\r\n\t#Get the minimum sellable area of all the apartments in a building\r\n\tgetMinimumArea:(building_id)->\r\n\t\tif building_id == \"\"\r\n\t\t\treturn\r\n\t\tunits = unitCollection.where\r\n\t\t\t\t\t'building_id' : building_id\r\n\t\ttemp = []\r\n\t\t$.each units,(index,value)->\r\n\t\t\tvariants = apartmentVariantCollection.findWhere\r\n\t\t\t\t\t\t\t'id' : value.get 'unit_variant_id'\r\n\t\t\ttemp.push variants.get 'super_built_up_area'\r\n\t\tmin= 0\r\n\t\tif temp.length != 0\t\r\n\t\t\tmin =  _.min temp\r\n\t\tmin\r\n\r\n\t#Get the minimum cost of all the apartments in a building\r\n\tgetMinimumCost:(building_id)->\r\n\t\tif building_id == \"\"\r\n\t\t\treturn\r\n\t\tunits = unitCollection.where\r\n\t\t\t\t\t'building_id' : building_id\r\n\t\ttemp = []\r\n\t\t$.each units,(index,value)->\r\n\t\t\tunits = unit.getUnitDetails(value.get('id'))\r\n\t\t\ttemp.push units[3]\r\n\r\n\t\tmin= 0\r\n\t\tif temp.length != 0\t\r\n\t\t\tmin =  _.min temp\r\n\t\tmin\r\n\t\t\r\n\r\n\r\n\t#get all the apartments in a building\r\n\tgetBuildingUnits:(building_id)->\r\n\t\tif building_id == \"\"\r\n\t\t\treturn\r\n\t\tunits = unitCollection.where\r\n\t\t\t\t\t'building_id' : building_id\r\n\r\n\t\tunitsFloor = _.sortBy(units, (num)->\r\n\t\t\t\treturn num.get('floor')\r\n\t\t\t);\r\n\t\tunitsPosition = _.sortBy(unitsFloor, (num)->\r\n\t\t\t\treturn num.get('position')\r\n\t\t\t);\r\n\t\tunits \r\n\r\n\t#Rotation view for a building\r\n\tcheckRotationView:(building)->\r\n\t\tif building == \"\"\r\n\t\t\treturn\r\n\t\ttransitionImages = []\r\n\t\tbuildingModel = buildingCollection.findWhere({'id':parseInt(building)})\r\n\t\tbreakpoints = buildingModel.get 'breakpoints'\r\n\t\t\r\n\t\tif parseInt(breakpoints.length) > 1\r\n\t\t\t@set 'rotation' , 1\r\n\t\telse\r\n\t\t\t@set 'rotation' , 0\r\n\r\n\t\t@get('rotation')\r\n\r\n\r\n\r\n\r\n\r\nclass BuildingCollection extends Backbone.Collection\r\n\tmodel : Building\r\n\r\n\tgetRecord:->\r\n\t\t@currentModel\r\n\r\n\tsetRecord:(model)->\r\n\t\t@currentModel = model\r\n\r\n\tnext:->\r\n\t\tunits = _.pluck @.toArray(), 'id'\r\n\t\tnext = @at(@indexOf(@getRecord()) + 1)\r\n\t\tif _.isUndefined next\r\n\t\t\tfirst = _.first units\r\n\t\t\tif @currentModel.get('id') == first\r\n\t\t\t\tnext\r\n\t\t\telse\r\n\t\t\t\trecord = @findWhere\r\n\t\t\t\t\t'id' : first\r\n\t\t\t\trecord\r\n\t\telse\r\n\t\t\tnext\r\n\r\n\tprev:->\r\n\t\tunits = _.pluck @.toArray(), 'id'\r\n\t\tprev = @at(@indexOf(@getRecord()) - 1)\r\n\t\tif _.isUndefined prev\r\n\t\t\tlast = _.last units\r\n\t\t\tif @currentModel.get('id') == last\r\n\t\t\t\tprev\r\n\t\t\telse\r\n\t\t\t\trecord = @findWhere\r\n\t\t\t\t\t'id' : last\r\n\t\t\t\trecord\r\n\t\telse\r\n\t\t\tprev\r\n\t\r\n\t\r\n\t#set the attributes of a building model\r\n\tsetBuildingAttributes:(data)->\r\n\r\n\t\t# @set buildingData\r\n\t\tbuildingCollection.reset data\r\n\t\tbuildingMasterCollection.reset data\r\n\r\nwindow.buildingCollection  = new BuildingCollection\r\nwindow.buildingMasterCollection  = new BuildingCollection\r\nwindow.building  = new Building"]}