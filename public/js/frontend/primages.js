if(!window.console)var console={log:function(){}};
var Pr={Options:{Debug:"?debug"===window.location.search||!1,HighQuality:90,UrlType:"uri",WatchResize:!0,WatchScroll:!0,WatchLoad:!0,OnlyVisible:!0,SearchSiblings:!0,ResBrPts:[160,320,480,768,1024,1224,1824],DpiMultiplier:1.5<=window.devicePixelRatio?2:1,QueryVars:{filename:"src",crop:"zc",filters:"fltr[]",quality:"q",width:"w",height:"h"}},BrowserInfo:{supportsEvtLstnr:"function"===typeof window.addEventListener,supportsElsByCln:void 0!==document.getElementsByClassName,isCrap:void 0===document.querySelectorAll},
Nodes:[],PrElement:function(b){this.imgMule=new Image;Pr.BrowserInfo.supportsEvtLstnr?(this.imgMule.addEventListener("load",function(){b.prototype.imgLoaded(b.prototype.imgMule.src)},!1),this.imgMule.addEventListener("error",function(a){console.log(a.type+" loading image: "+b.prototype.imgMule.src)},!1)):(this.imgMule.attachEvent("onload",function(){b.prototype.imgLoaded(b.prototype.imgMule.src)}),this.imgMule.attachEvent("onerror",function(a){console.log(a.type+" loading image: "+b.prototype.imgMule.src)}));
this.ImgData={path:b.getAttribute("data-path").substring(0,b.getAttribute("data-path").lastIndexOf("/")+1),filename:b.getAttribute("data-path").substring(b.getAttribute("data-path").lastIndexOf("/")+1),procPath:b.getAttribute("data-imgprocessor"),crop:parseInt(b.getAttribute("data-crop"),10),filters:b.getAttribute("data-filters"),srcWidth:b.getAttribute("data-srcwidth"),ratio:b.getAttribute("data-ratio"),quality:0,width:0,height:0,urlCache:{}};this.isVisible=function(){var a=b.getBoundingClientRect();
return 0<a.height&&0<a.width&&0<=a.bottom&&0<=a.right&&a.top<=(window.innerHeight||document.documentElement.clientHeight)&&a.left<=(window.innerWidth||document.documentElement.clientWidth)};this.imgLoaded=function(a){"DIV"===b.tagName?b.style.backgroundImage="url('"+a+"')":b.src=a;Pr.Options.Debug&&this.DebugInfo.show()};this.getDimensions=function(a){var e=[b.offsetWidth,b.offsetHeight];if(0===e[0]&&a){for(a=b.parentNode.firstElementChild;a&&1===a.nodeType&&a!==this;){if(0<a.offsetWidth){e=[a.offsetWidth,
a.offsetHeight];break}a=a.nextElementSibling||a.nextSibling}if(0===e[0]){a=3;for(var c=b.parentNode;0===e[0]&&0<a;)e=[c.offsetWidth,c.offsetHeight],c=c.parentNode,--a}}return e};this.normalizedDimensions=function(){var a,b,c=Pr.Options.ResBrPts.concat([this.ImgData.srcWidth]),d=this.getDimensions(Pr.Options.SearchSiblings),f=parseFloat(this.ImgData.ratio)||Math.round(d[1]/d[0]*100)/100;for(a=0;a<c.length-1&&!(d[0]*Pr.Options.DpiMultiplier<=c[a]&&c[a]*f>=d[1]);a+=1);d={width:c[a],height:this.ImgData.crop?
Math.round(c[a]*f):0,quality:Pr.Options.HighQuality,ratio:f};Pr.Options.Debug&&(this.DebugInfo.scaledUp=this.ImgData.width<d.width,this.DebugInfo.isMax=a===c.length-1);for(b in this.ImgData)this.ImgData.hasOwnProperty(b)&&!d.hasOwnProperty(b)&&(d[b]=this.ImgData[b]);return d};this.buildUrl=function(a){var b="";if(this.ImgData.urlCache[a.width])b=this.ImgData.urlCache[a.width];else{if(!Pr.Options.UrlType||"uri"===Pr.Options.UrlType)b=a.path+"resized/"+a.width+"/"+a.height+"/"+a.quality+"/"+a.crop+
"/"+a.filters+"/"+a.filename;else if("query"===Pr.Options.UrlType){var b=a.procPath+"?"+Pr.Options.QueryVars.filename+"="+a.path+a.filename+"&"+Pr.Options.QueryVars.width+"="+a.width+"&"+Pr.Options.QueryVars.height+"="+a.height+"&"+Pr.Options.QueryVars.quality+"="+a.quality+"&"+Pr.Options.QueryVars.crop+"="+a.crop,c=a.filters.split("+"),d;for(d=0;d<c.length;d+=1)b+="&"+Pr.Options.QueryVars.filters+"="+c[d]}this.ImgData.urlCache[a.width]=b}return b};this.loadResponsiveImg=function(){var a=!!b.getAttribute("data-alwaysprocess");
(Pr.Options.OnlyVisible&&!a?this.isVisible():1)?(Pr.Options.Debug&&console.log("ok, node visible"),a=this.normalizedDimensions(),this.ImgData.width!==a.width&&(this.imgMule.src=this.buildUrl(a),this.ImgData=a,Pr.Options.Debug&&this.DebugInfo.show("Preloading new image..."))):Pr.Options.Debug&&console.log("not ok, node not visible")};this.DebugInfo={forNode:this,scaledUp:!1,isMax:!1,show:function(a){var e=this.forNode;if(!b.getAttribute("data-nodebug")){!b.nextSibling||"infodiv preloading"!==b.nextSibling.className&&
"infodiv"!==b.nextSibling.className||b.nextSibling.parentNode.removeChild(b.nextSibling);b.querySelectorAll(".infodiv")[0]&&b.removeChild(b.querySelectorAll(".infodiv")[0]);var c=document.createElement("DIV");if(a)c.innerHTML=a,c.className="infodiv preloading";else{c.innerHTML="Elem: "+b.offsetWidth+"x"+b.offsetHeight+", Img: "+e.ImgData.width+"x"+e.ImgData.height+(1<Pr.Options.DpiMultiplier?" (Retina)":"");e.ImgData.crop&&(c.innerHTML+=" (cropped)");this.isMax&&(c.innerHTML+=" (max dimensions)");
var d=document.createElement("SPAN");d.innerHTML="Image adjusted"+(this.scaledUp?" up":" down");d.className="updated";c.appendChild(d);setTimeout(function(){d.parentNode.removeChild(d)},2E3);c.className="infodiv"}"DIV"!==b.tagName?b.nextSibling?b.parentNode.insertBefore(c,b.nextSibling):b.parentNode.appendChild(c):b.appendChild(c)}}};this.loadResponsiveImg()},Reprocess:function(){var b;for(b=0;b<Pr.Nodes.length;b+=1)Pr.Nodes[b].prototype.loadResponsiveImg()},ProcessImages:function(b){if(Pr.BrowserInfo.isCrap)"?forcenojs"!==
window.location.search&&(window.location="?forcenojs");else{b=Pr.BrowserInfo.supportsElsByCln?document.getElementsByClassName(b):document.querySelectorAll("."+b);var a;for(a=0;a<b.length;a+=1)b[a].getAttribute("data-path")&&b[a].getAttribute("data-imgprocessor")?(b[a].prototype=new Pr.PrElement(b[a]),Pr.Nodes.push(b[a])):console.log("Missing data attributes for:"+(b[a].id||"(no id available)")+". Skipping...")}}};
Pr.Reprocess.deBounce=function(b,a,e){var c=this,d;return function(){var f=this;d?clearTimeout(d):a&&c.apply(f,[e]);d=setTimeout(function(b){a||c.apply(f,[e]);d=null},b||100)}};var support="function"===typeof window.hasOwnProperty?window.hasOwnProperty("onorientationchange"):!1,orientationEvent=support?"orientationchange":"resize";
Pr.BrowserInfo.supportsEvtLstnr?document.addEventListener("DOMContentLoaded",function(){Pr.ProcessImages("primage");Pr.Options.WatchResize&&window.addEventListener(orientationEvent,Pr.Reprocess.deBounce(100,!1,"resizeEvent"),!1);Pr.Options.WatchScroll&&window.addEventListener("scroll",Pr.Reprocess.deBounce(50,!1,"scrollEvent"),!1);Pr.Options.WatchLoad&&window.addEventListener("load",Pr.Reprocess.deBounce(50,!1,"loadEvent"),!1)},!1):document.attachEvent("onreadystatechange",function(){Pr.ProcessImages("primage");
Pr.Options.WatchResize&&window.attachEvent("on"+orientationEvent,Pr.Reprocess.deBounce(100,!1,"resizeEvent"));Pr.Options.WatchScroll&&window.attachEvent("onscroll",Pr.Reprocess.deBounce(50,!1,"scrollEvent"))});window.jQuery&&"function"===typeof jQuery&&(jQuery.fn.reprocessPrImg=function(){return this.each(function(){void 0!==this.prototype&&this.prototype.loadResponsiveImg()})});