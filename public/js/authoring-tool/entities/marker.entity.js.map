{"version":3,"sources":["authoring-tool/entities/marker.entity.coffee"],"names":[],"mappings":"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","file":"authoring-tool/entities/marker.entity.js","sourceRoot":"/source/","sourcesContent":["#functions of a marker\r\n#1.create a marker using svgs\r\n#2.Function to make polygon draggable\r\n#event handler functions\r\n\r\n\r\n\r\nclass Marker extends Backbone.Model\r\n\r\n    generateMarkerTag:(item)->\r\n        # get marker type\r\n        markerType = item.other_details.marker_type\r\n        cx = item.other_details.cx\r\n        cy = item.other_details.cy\r\n        innerRadius = item.other_details.innerRadius\r\n        outerRadius = item.other_details.outerRadius\r\n        ellipseWidth = item.other_details.ellipseWidth\r\n        ellipseHeight = item.other_details.ellipseHeight\r\n\r\n        # additional classes \r\n        typeClass = item['other_details']['class'] \r\n        points = item.points\r\n\r\n        drawMarkerElements = []\r\n        \r\n        # draw marker group\r\n        groupMarker = draw.group()\r\n        groupMarker.attr\r\n            class: 'marker-grp'\r\n            type: item.object_type \r\n            id:  item.object_id \r\n            svgid:  item.id \r\n\r\n    \r\n        #set data attributes for title and description if object type is amenity\r\n        if item.object_type is \"amenity\"\r\n            groupMarker.data('amenity-title', item.other_details.title)\r\n            groupMarker.data('amenity-desc', item.other_details.description)\r\n\r\n\r\n        switch markerType\r\n          when 'concentric'\r\n            # add class based on marker type \r\n            groupMarker.addClass('concentric')\r\n            groupMarker.addClass(typeClass)\r\n\r\n            circle1 = draw.circle(innerRadius)\r\n            circle1.attr\r\n                fill: '#FF8500'\r\n                cx: points[0]\r\n                cy: points[1]\r\n\r\n            circle2 = draw.circle(outerRadius)\r\n            \r\n            circle2.attr\r\n                fill: 'none'\r\n                cx: points[0]\r\n                cy: points[1]\r\n                stroke: \"#FF7900\"\r\n                'stroke-width':4 \r\n                'stroke-miterlimit':10\r\n\r\n            drawMarkerElements.push circle1\r\n            drawMarkerElements.push circle2\r\n\r\n            break\r\n                \r\n          when 'solid'\r\n            window.canvas_type = \"solidMarker\"\r\n \r\n            # add class based on marker type \r\n            groupMarker.addClass('solid')\r\n            groupMarker.addClass(typeClass)            \r\n\r\n            circle = draw.circle(outerRadius)\r\n            circle.attr\r\n                cx: points[0]\r\n                cy: points[1]\r\n\r\n            drawMarkerElements.push circle\r\n            break\r\n\r\n          when 'location'\r\n            window.canvas_type = \"locationMarker\"\r\n \r\n            # add class based on marker type \r\n            groupMarker.addClass('location')\r\n            groupMarker.addClass(typeClass)    #typeclass = marker        \r\n\r\n            polygon = draw.polygon('776.906,408.457 821.094,407 798.01,459.243')\r\n            polygon.attr\r\n                fill: '#F7931E'\r\n\r\n            drawMarkerElements.push polygon\r\n\r\n            ellipse = draw.ellipse(40,40)\r\n\r\n            ellipse.attr\r\n                'fill': '#FFFFFF'\r\n                'stroke': '#F7931E'\r\n                'stroke-width': 6\r\n                'stroke-miterlimit' : 10\r\n                cx:points[0]\r\n                cy:points[1]\r\n\r\n            drawMarkerElements.push ellipse\r\n            break            \r\n\r\n          when 'earthlocation'\r\n            window.canvas_type = \"earthlocationMarker\"\r\n \r\n            # add class based on marker type \r\n            groupMarker.addClass('earthlocation')\r\n\r\n            # check if it has location marker as well\r\n            details = item.other_details\r\n            # unless _.isUndefined(details['location_marker_class']) \r\n            #     @generateLocationMarker(item)\r\n            \r\n            \r\n            ellipse = draw.ellipse(window.ellipseWidth, window.ellipseHeight)\r\n            ellipse.addClass(typeClass)\r\n\r\n            ellipse.attr\r\n                'fill': '#FF6700'\r\n                'stroke': '#FF7300'\r\n                'stroke-width':3\r\n                'fill-opacity':0.2\r\n                'stroke-miterlimit':10\r\n                cx: points[0]\r\n                cy: points[1]\r\n\r\n            drawMarkerElements.push ellipse\r\n            break            \r\n\r\n        _.each drawMarkerElements, (markerElement, key) =>\r\n            groupMarker.add(markerElement) \r\n\r\n    generateLocationMarker:(item)-> \r\n        details = item.other_details\r\n        groupLocation = draw.group()\r\n        groupLocation.attr\r\n            class: details['location_marker_class']\r\n            \r\n\r\n        groupLocation.addClass('marker')\r\n\r\n        dx = parseInt details['location_marker_x']\r\n        dy = parseInt details['location_marker_y']\r\n\r\n        pointsArr = []\r\n        pointsArr.push (parseInt(776.906) + dx)\r\n        pointsArr.push (parseInt(408.457) + dy)\r\n        pointsArr.push (parseInt(821.094) + dx)\r\n        pointsArr.push (parseInt(407) + dy)\r\n        pointsArr.push (parseInt(798.01) + dx)\r\n        pointsArr.push (parseInt(459.243)  + dy) \r\n\r\n        pointList = @getPointList(pointsArr)\r\n        pointList = pointList.join(' ')\r\n        \r\n        polygon = draw.polygon(pointList) \r\n        \r\n        polygon.attr\r\n            fill: '#F7931E'\r\n\r\n        groupLocation.add(polygon) \r\n\r\n        ellipse = draw.ellipse(40,40)\r\n\r\n        eCx = 798.696 + dx\r\n        eCy = 401.52 + dy\r\n        ellipse.attr\r\n            'fill': '#FFFFFF'\r\n            'stroke': '#F7931E'\r\n            'stroke-width': 6\r\n            'stroke-miterlimit' : 10\r\n            cx:eCx\r\n            cy:eCy\r\n\r\n\r\n    getPointList:(pointsArr)->\r\n        pointList = []\r\n\r\n        i= 0\r\n        l = pointsArr.length\r\n        while i < l\r\n            pointList.push([parseInt(pointsArr[i]),parseInt(pointsArr[i+1])])\r\n            i+=2\r\n        \r\n        formattedPoints = []\r\n        k= 0\r\n        len = pointList.length\r\n        \r\n        while k< len\r\n            formattedPoints.push(pointList[k].join())\r\n            k++\r\n\r\n        return formattedPoints                         \r\n\r\n           \r\n\r\nwindow.marker = new Marker"]}